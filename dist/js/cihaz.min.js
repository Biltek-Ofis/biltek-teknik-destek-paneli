var base_url=window.location.origin,islemBilgileriHover=[!1,!1,!1,!1,!1],stok_bilgileri_onaylandi=[!1,!1,!1,!1,!1];function islemHesapla(a){var e=$("#yapilanIslemMiktar"+a).val()??0,f=$("#yapilanIslemFiyat"+a).val()??0,c=$("#yapilanIslemKdv"+a).val()??0,b=e*f,d=Math.ceil(b/100*c);$("#yapilanIslemTutar"+a).html(b>0?b+" TL":""),$("#yapilanIslemTopKdv"+a).html(d>0?d+" TL ("+c+"%)":""),tutarHesapla()}function tutarHesapla(){var b=0,c=0;for(let a=1;a<=5;a++){var f=$("#yapilanIslemMiktar"+a).val()??0,g=$("#yapilanIslemFiyat"+a).val()??0,h=$("#yapilanIslemKdv"+a).val()??0,d=f*g,i=Math.ceil(d/100*h);c+=i,b+=d}var e=b+c;$("#yapilanIslemToplam").html(b>0?b+" TL":""),$("#yapilanIslemKdv").html(c>0?c+" TL":""),$("#yapilanIslemGenelToplam").html(e>0?e+" TL":"")}function stoklariGetir(a,b){a.length>1&&$.post(base_url+"/js/stok",{ara:a},function(a){var c=JSON.parse(a);Object.keys(c).length>0?($("#stok_liste_"+b).html(""),$.each(JSON.parse(a),function(a,c){var d=$('<li class="active"><a class="dropdown-item" href="javascript:void(0);" id="stok_adi_liste_oge_'+b+"_"+a+'" role="option">'+c.STOK_ADI+"</a></li>");$("#stok_liste_"+b).append(d),$("#stok_adi_liste_oge_"+b+"_"+a).on("click",function(){stokVerileri(c,b)})}),$("#stok_liste_"+b).show()):($("#stok_liste_"+b).html(""),$("#stok_liste_"+b).hide())})}function stokVerileri(a,b){$("#stokKodText"+b).html(a.STOK_KODU?a.STOK_KODU:"Yok"),$("#yapilanIslemStokKod"+b).val(a.STOK_KODU?a.STOK_KODU:""),$("#yapilanIslemMiktar"+b).val(1),$("#yapilanIslem"+b).val(a.STOK_ADI?a.STOK_ADI:""),$("#yapilanIslemFiyat"+b).val(parseFloat(a.SATIS_FIAT1?a.SATIS_FIAT1:0).toFixed(2)),$("#yapilanIslemKdv"+b).val(a.KDV_ORANI?a.KDV_ORANI:0),stok_bilgileri_onaylandi[b-1]=!0,$("#stok_liste_"+b).hide(),islemHesapla(b)}function _(a){return document.getElementById(a)}function dosyaYukle(c){var d=_("yuklenecekDosya").files[0],b=new FormData;b.append("yuklenecekDosya",d);var a=new XMLHttpRequest;a.upload.addEventListener("progress",ilerlemeDurumu,!1),a.addEventListener("load",tamamlamaDurumu,!1),a.addEventListener("error",hataDurumu,!1),a.addEventListener("abort",iptalDurumu,!1),a.open("POST",base_url+"/cihaz/medyaYukle/"+c),a.send(b)}function ilerlemeDurumu(a){var c=new Number(a.loaded/1048576),d=new Number(a.total/1048576);_("yukleme_durumu").innerHTML="Y\xfcklendi: "+c.toPrecision(5)+" MB / "+d.toPrecision(5)+" MB";var b=a.loaded/a.total*100;_("progressBar").value=Math.round(b),_("durum").innerHTML=Math.round(b)+"% y\xfcklendi"}function tamamlamaDurumu(b){var a=JSON.parse(b.target.responseText);_("durum").innerHTML=a.mesaj,_("progressBar").value=0,document.getElementById("progressDiv").style.display="none",0==a.sonuc&&(_("yukleme_durumu").innerHTML=""),1==a.sonuc&&window.location.reload()}function hataDurumu(a){_("durum").innerHTML="Y\xfckleme Ba\u015Far\u0131s\u0131z"}function iptalDurumu(a){_("durum").innerHTML="Y\xfckleme \u0130ptal Edildi"}$(document).ready(function(){for(let a=1;a<=5;a++)$("#yapilanIslem"+a).focus,$("#stok_liste_"+a).hover(function(){islemBilgileriHover[a-1]=!0},function(){islemBilgileriHover[a-1]=!1}),$("#yapilanIslem"+a).focusout(function(){islemBilgileriHover[a-1]||$("#stok_liste_"+a).hide()}),$("#yapilanIslem"+a).focus(function(){var b=$("#yapilanIslem"+a).val();stok_bilgileri_onaylandi[a-1]||stoklariGetir(b,a)}),$("#yapilanIslem"+a).keyup(function(){$("#stokKodText"+a).html("Yok"),$("#yapilanIslemStokKod"+a).val("");var b=$("#yapilanIslem"+a).val();b.length>0?($("#yapilanIslemMiktar"+a).prop("required",!0),$("#yapilanIslemFiyat"+a).prop("required",!0)):($("#yapilanIslemMiktar"+a).prop("required",!1),$("#yapilanIslemFiyat"+a).prop("required",!1)),stoklariGetir(b,a)}),$("#yapilanIslemMiktar"+a+", #yapilanIslemFiyat"+a+", #yapilanIslemKdv"+a).keyup(function(){islemHesapla(a)})})